import{u as Tt,i as Ft}from"./action-cd384d03.js";import{d as Vt,z as Ut,r as it,f as Mt,c as At,w as st,a0 as Qt,v as H,m as It,k as Et,j as A,a1 as Pt,n as $t,l as qt,F as Lt,L as Ht,y as Gt,a2 as jt,T as St,D as Xt,A as Yt,B as Wt,C as Zt,E as Jt}from"./tool-4bde39df.js";import{d as Kt,a as te,g as ee}from"./util-1c5566eb.js";import"./modulepreload-polyfill-3cfb730f.js";const Dt=Vt({__name:"GenerateOptionColor",props:{modelValue:{type:Object,default:()=>Kt("#ffffff")},size:{type:String,default:"default"}},emits:["update:modelValue"],setup(gt,{emit:yt}){const bt=gt,S=Ut({get:()=>bt.modelValue,set:W=>yt("update:modelValue",W)});return(W,U)=>{const F=it("Bool"),N=it("Color"),k=it("Radio"),P=it("InputNumber"),_t=it("Align");return Mt(),At(_t,null,{default:st(()=>[Qt(W.$slots,"default"),H(F,{border:"",size:gt.size,modelValue:S.value.is_gradient,"onUpdate:modelValue":U[0]||(U[0]=T=>S.value.is_gradient=T),label:W.$t("qrCode_generate_option_gradient")},null,8,["size","modelValue","label"]),S.value.is_gradient?It("",!0):(Mt(),At(N,{key:0,size:gt.size,modelValue:S.value.simple,"onUpdate:modelValue":U[1]||(U[1]=T=>S.value.simple=T)},null,8,["size","modelValue"])),S.value.is_gradient?(Mt(),Et(Lt,{key:1},[H(N,{size:gt.size,modelValue:S.value.gradient.colorStops[0].color,"onUpdate:modelValue":U[2]||(U[2]=T=>S.value.gradient.colorStops[0].color=T)},null,8,["size","modelValue"]),H(N,{size:gt.size,modelValue:S.value.gradient.colorStops[1].color,"onUpdate:modelValue":U[3]||(U[3]=T=>S.value.gradient.colorStops[1].color=T)},null,8,["size","modelValue"]),H(k,{size:gt.size,modelValue:S.value.gradient.type,"onUpdate:modelValue":U[4]||(U[4]=T=>S.value.gradient.type=T),options:A(Pt)(["linear","radial"],"qrCode_generate_option_"),button:""},null,8,["size","modelValue","options"]),H(P,{size:gt.size,modelValue:S.value.gradient.rotation,"onUpdate:modelValue":U[5]||(U[5]=T=>S.value.gradient.rotation=T),min:0,max:360,width:100},{prepend:st(()=>[$t(qt(W.$t("qrCode_generate_option_rotation")),1)]),_:1},8,["size","modelValue"])],64)):It("",!0)]),_:3})}}});var Nt={exports:{}};(function(gt,yt){(function(bt,S){gt.exports=S()})(self,()=>(()=>{var bt={192:(F,N)=>{var k,P,_t=function(){var T=function(p,f){var _=p,u=pt[f],h=null,m=0,y=null,v=[],x={},G=function(r,s){h=function(c){for(var l=new Array(c),d=0;d<c;d+=1){l[d]=new Array(c);for(var g=0;g<c;g+=1)l[d][g]=null}return l}(m=4*_+17),X(0,0),X(m-7,0),X(0,m-7),e(),M(),o(r,s),_>=7&&t(r),y==null&&(y=i(_,u,v)),n(y,s)},X=function(r,s){for(var c=-1;c<=7;c+=1)if(!(r+c<=-1||m<=r+c))for(var l=-1;l<=7;l+=1)s+l<=-1||m<=s+l||(h[r+c][s+l]=0<=c&&c<=6&&(l==0||l==6)||0<=l&&l<=6&&(c==0||c==6)||2<=c&&c<=4&&2<=l&&l<=4)},M=function(){for(var r=8;r<m-8;r+=1)h[r][6]==null&&(h[r][6]=r%2==0);for(var s=8;s<m-8;s+=1)h[6][s]==null&&(h[6][s]=s%2==0)},e=function(){for(var r=rt.getPatternPosition(_),s=0;s<r.length;s+=1)for(var c=0;c<r.length;c+=1){var l=r[s],d=r[c];if(h[l][d]==null)for(var g=-2;g<=2;g+=1)for(var w=-2;w<=2;w+=1)h[l+g][d+w]=g==-2||g==2||w==-2||w==2||g==0&&w==0}},t=function(r){for(var s=rt.getBCHTypeNumber(_),c=0;c<18;c+=1){var l=!r&&(s>>c&1)==1;h[Math.floor(c/3)][c%3+m-8-3]=l}for(c=0;c<18;c+=1)l=!r&&(s>>c&1)==1,h[c%3+m-8-3][Math.floor(c/3)]=l},o=function(r,s){for(var c=u<<3|s,l=rt.getBCHTypeInfo(c),d=0;d<15;d+=1){var g=!r&&(l>>d&1)==1;d<6?h[d][8]=g:d<8?h[d+1][8]=g:h[m-15+d][8]=g}for(d=0;d<15;d+=1)g=!r&&(l>>d&1)==1,d<8?h[8][m-d-1]=g:d<9?h[8][15-d-1+1]=g:h[8][15-d-1]=g;h[m-8][8]=!r},n=function(r,s){for(var c=-1,l=m-1,d=7,g=0,w=rt.getMaskFunction(s),b=m-1;b>0;b-=2)for(b==6&&(b-=1);;){for(var C=0;C<2;C+=1)if(h[l][b-C]==null){var O=!1;g<r.length&&(O=(r[g]>>>d&1)==1),w(l,b-C)&&(O=!O),h[l][b-C]=O,(d-=1)==-1&&(g+=1,d=7)}if((l+=c)<0||m<=l){l-=c,c=-c;break}}},i=function(r,s,c){for(var l=B.getRSBlocks(r,s),d=dt(),g=0;g<c.length;g+=1){var w=c[g];d.put(w.getMode(),4),d.put(w.getLength(),rt.getLengthInBits(w.getMode(),r)),w.write(d)}var b=0;for(g=0;g<l.length;g+=1)b+=l[g].dataCount;if(d.getLengthInBits()>8*b)throw"code length overflow. ("+d.getLengthInBits()+">"+8*b+")";for(d.getLengthInBits()+4<=8*b&&d.put(0,4);d.getLengthInBits()%8!=0;)d.putBit(!1);for(;!(d.getLengthInBits()>=8*b||(d.put(236,8),d.getLengthInBits()>=8*b));)d.put(17,8);return function(C,O){for(var z=0,Y=0,Q=0,V=new Array(O.length),j=new Array(O.length),D=0;D<O.length;D+=1){var nt=O[D].dataCount,tt=O[D].totalCount-nt;Y=Math.max(Y,nt),Q=Math.max(Q,tt),V[D]=new Array(nt);for(var q=0;q<V[D].length;q+=1)V[D][q]=255&C.getBuffer()[q+z];z+=nt;var L=rt.getErrorCorrectPolynomial(tt),I=ft(V[D],L.getLength()-1).mod(L);for(j[D]=new Array(L.getLength()-1),q=0;q<j[D].length;q+=1){var E=q+I.getLength()-j[D].length;j[D][q]=E>=0?I.getAt(E):0}}var Z=0;for(q=0;q<O.length;q+=1)Z+=O[q].totalCount;var K=new Array(Z),$=0;for(q=0;q<Y;q+=1)for(D=0;D<O.length;D+=1)q<V[D].length&&(K[$]=V[D][q],$+=1);for(q=0;q<Q;q+=1)for(D=0;D<O.length;D+=1)q<j[D].length&&(K[$]=j[D][q],$+=1);return K}(d,l)};x.addData=function(r,s){var c=null;switch(s=s||"Byte"){case"Numeric":c=mt(r);break;case"Alphanumeric":c=wt(r);break;case"Byte":c=Ot(r);break;case"Kanji":c=Ct(r);break;default:throw"mode:"+s}v.push(c),y=null},x.isDark=function(r,s){if(r<0||m<=r||s<0||m<=s)throw r+","+s;return h[r][s]},x.getModuleCount=function(){return m},x.make=function(){if(_<1){for(var r=1;r<40;r++){for(var s=B.getRSBlocks(r,u),c=dt(),l=0;l<v.length;l++){var d=v[l];c.put(d.getMode(),4),c.put(d.getLength(),rt.getLengthInBits(d.getMode(),r)),d.write(c)}var g=0;for(l=0;l<s.length;l++)g+=s[l].dataCount;if(c.getLengthInBits()<=8*g)break}_=r}G(!1,function(){for(var w=0,b=0,C=0;C<8;C+=1){G(!0,C);var O=rt.getLostPoint(x);(C==0||w>O)&&(w=O,b=C)}return b}())},x.createTableTag=function(r,s){r=r||2;var c="";c+='<table style="',c+=" border-width: 0px; border-style: none;",c+=" border-collapse: collapse;",c+=" padding: 0px; margin: "+(s=s===void 0?4*r:s)+"px;",c+='">',c+="<tbody>";for(var l=0;l<x.getModuleCount();l+=1){c+="<tr>";for(var d=0;d<x.getModuleCount();d+=1)c+='<td style="',c+=" border-width: 0px; border-style: none;",c+=" border-collapse: collapse;",c+=" padding: 0px; margin: 0px;",c+=" width: "+r+"px;",c+=" height: "+r+"px;",c+=" background-color: ",c+=x.isDark(l,d)?"#000000":"#ffffff",c+=";",c+='"/>';c+="</tr>"}return(c+="</tbody>")+"</table>"},x.createSvgTag=function(r,s,c,l){var d={};typeof arguments[0]=="object"&&(r=(d=arguments[0]).cellSize,s=d.margin,c=d.alt,l=d.title),r=r||2,s=s===void 0?4*r:s,(c=typeof c=="string"?{text:c}:c||{}).text=c.text||null,c.id=c.text?c.id||"qrcode-description":null,(l=typeof l=="string"?{text:l}:l||{}).text=l.text||null,l.id=l.text?l.id||"qrcode-title":null;var g,w,b,C,O=x.getModuleCount()*r+2*s,z="";for(C="l"+r+",0 0,"+r+" -"+r+",0 0,-"+r+"z ",z+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',z+=d.scalable?"":' width="'+O+'px" height="'+O+'px"',z+=' viewBox="0 0 '+O+" "+O+'" ',z+=' preserveAspectRatio="xMinYMin meet"',z+=l.text||c.text?' role="img" aria-labelledby="'+a([l.id,c.id].join(" ").trim())+'"':"",z+=">",z+=l.text?'<title id="'+a(l.id)+'">'+a(l.text)+"</title>":"",z+=c.text?'<description id="'+a(c.id)+'">'+a(c.text)+"</description>":"",z+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',z+='<path d="',w=0;w<x.getModuleCount();w+=1)for(b=w*r+s,g=0;g<x.getModuleCount();g+=1)x.isDark(w,g)&&(z+="M"+(g*r+s)+","+b+C);return(z+='" stroke="transparent" fill="black"/>')+"</svg>"},x.createDataURL=function(r,s){r=r||2,s=s===void 0?4*r:s;var c=x.getModuleCount()*r+2*s,l=s,d=c-s;return vt(c,c,function(g,w){if(l<=g&&g<d&&l<=w&&w<d){var b=Math.floor((g-l)/r),C=Math.floor((w-l)/r);return x.isDark(C,b)?0:1}return 1})},x.createImgTag=function(r,s,c){r=r||2,s=s===void 0?4*r:s;var l=x.getModuleCount()*r+2*s,d="";return d+="<img",d+=' src="',d+=x.createDataURL(r,s),d+='"',d+=' width="',d+=l,d+='"',d+=' height="',d+=l,d+='"',c&&(d+=' alt="',d+=a(c),d+='"'),d+"/>"};var a=function(r){for(var s="",c=0;c<r.length;c+=1){var l=r.charAt(c);switch(l){case"<":s+="&lt;";break;case">":s+="&gt;";break;case"&":s+="&amp;";break;case'"':s+="&quot;";break;default:s+=l}}return s};return x.createASCII=function(r,s){if((r=r||1)<2)return function(V){V=V===void 0?2:V;var j,D,nt,tt,q,L=1*x.getModuleCount()+2*V,I=V,E=L-V,Z={"██":"█","█ ":"▀"," █":"▄","  ":" "},K={"██":"▀","█ ":"▀"," █":" ","  ":" "},$="";for(j=0;j<L;j+=2){for(nt=Math.floor((j-I)/1),tt=Math.floor((j+1-I)/1),D=0;D<L;D+=1)q="█",I<=D&&D<E&&I<=j&&j<E&&x.isDark(nt,Math.floor((D-I)/1))&&(q=" "),I<=D&&D<E&&I<=j+1&&j+1<E&&x.isDark(tt,Math.floor((D-I)/1))?q+=" ":q+="█",$+=V<1&&j+1>=E?K[q]:Z[q];$+=`
`}return L%2&&V>0?$.substring(0,$.length-L-1)+Array(L+1).join("▀"):$.substring(0,$.length-1)}(s);r-=1,s=s===void 0?2*r:s;var c,l,d,g,w=x.getModuleCount()*r+2*s,b=s,C=w-s,O=Array(r+1).join("██"),z=Array(r+1).join("  "),Y="",Q="";for(c=0;c<w;c+=1){for(d=Math.floor((c-b)/r),Q="",l=0;l<w;l+=1)g=1,b<=l&&l<C&&b<=c&&c<C&&x.isDark(d,Math.floor((l-b)/r))&&(g=0),Q+=g?O:z;for(d=0;d<r;d+=1)Y+=Q+`
`}return Y.substring(0,Y.length-1)},x.renderTo2dContext=function(r,s){s=s||2;for(var c=x.getModuleCount(),l=0;l<c;l++)for(var d=0;d<c;d++)r.fillStyle=x.isDark(l,d)?"black":"white",r.fillRect(l*s,d*s,s,s)},x};T.stringToBytes=(T.stringToBytesFuncs={default:function(p){for(var f=[],_=0;_<p.length;_+=1){var u=p.charCodeAt(_);f.push(255&u)}return f}}).default,T.createStringToBytes=function(p,f){var _=function(){for(var h=kt(p),m=function(){var M=h.read();if(M==-1)throw"eof";return M},y=0,v={};;){var x=h.read();if(x==-1)break;var G=m(),X=m()<<8|m();v[String.fromCharCode(x<<8|G)]=X,y+=1}if(y!=f)throw y+" != "+f;return v}(),u="?".charCodeAt(0);return function(h){for(var m=[],y=0;y<h.length;y+=1){var v=h.charCodeAt(y);if(v<128)m.push(v);else{var x=_[h.charAt(y)];typeof x=="number"?(255&x)==x?m.push(x):(m.push(x>>>8),m.push(255&x)):m.push(u)}}return m}};var ht,et,ot,R,J,pt={L:1,M:0,Q:3,H:2},rt=(ht=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],et=1335,ot=7973,J=function(p){for(var f=0;p!=0;)f+=1,p>>>=1;return f},(R={}).getBCHTypeInfo=function(p){for(var f=p<<10;J(f)-J(et)>=0;)f^=et<<J(f)-J(et);return 21522^(p<<10|f)},R.getBCHTypeNumber=function(p){for(var f=p<<12;J(f)-J(ot)>=0;)f^=ot<<J(f)-J(ot);return p<<12|f},R.getPatternPosition=function(p){return ht[p-1]},R.getMaskFunction=function(p){switch(p){case 0:return function(f,_){return(f+_)%2==0};case 1:return function(f,_){return f%2==0};case 2:return function(f,_){return _%3==0};case 3:return function(f,_){return(f+_)%3==0};case 4:return function(f,_){return(Math.floor(f/2)+Math.floor(_/3))%2==0};case 5:return function(f,_){return f*_%2+f*_%3==0};case 6:return function(f,_){return(f*_%2+f*_%3)%2==0};case 7:return function(f,_){return(f*_%3+(f+_)%2)%2==0};default:throw"bad maskPattern:"+p}},R.getErrorCorrectPolynomial=function(p){for(var f=ft([1],0),_=0;_<p;_+=1)f=f.multiply(ft([1,lt.gexp(_)],0));return f},R.getLengthInBits=function(p,f){if(1<=f&&f<10)switch(p){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+p}else if(f<27)switch(p){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+p}else{if(!(f<41))throw"type:"+f;switch(p){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+p}}},R.getLostPoint=function(p){for(var f=p.getModuleCount(),_=0,u=0;u<f;u+=1)for(var h=0;h<f;h+=1){for(var m=0,y=p.isDark(u,h),v=-1;v<=1;v+=1)if(!(u+v<0||f<=u+v))for(var x=-1;x<=1;x+=1)h+x<0||f<=h+x||v==0&&x==0||y==p.isDark(u+v,h+x)&&(m+=1);m>5&&(_+=3+m-5)}for(u=0;u<f-1;u+=1)for(h=0;h<f-1;h+=1){var G=0;p.isDark(u,h)&&(G+=1),p.isDark(u+1,h)&&(G+=1),p.isDark(u,h+1)&&(G+=1),p.isDark(u+1,h+1)&&(G+=1),G!=0&&G!=4||(_+=3)}for(u=0;u<f;u+=1)for(h=0;h<f-6;h+=1)p.isDark(u,h)&&!p.isDark(u,h+1)&&p.isDark(u,h+2)&&p.isDark(u,h+3)&&p.isDark(u,h+4)&&!p.isDark(u,h+5)&&p.isDark(u,h+6)&&(_+=40);for(h=0;h<f;h+=1)for(u=0;u<f-6;u+=1)p.isDark(u,h)&&!p.isDark(u+1,h)&&p.isDark(u+2,h)&&p.isDark(u+3,h)&&p.isDark(u+4,h)&&!p.isDark(u+5,h)&&p.isDark(u+6,h)&&(_+=40);var X=0;for(h=0;h<f;h+=1)for(u=0;u<f;u+=1)p.isDark(u,h)&&(X+=1);return _+Math.abs(100*X/f/f-50)/5*10},R),lt=function(){for(var p=new Array(256),f=new Array(256),_=0;_<8;_+=1)p[_]=1<<_;for(_=8;_<256;_+=1)p[_]=p[_-4]^p[_-5]^p[_-6]^p[_-8];for(_=0;_<255;_+=1)f[p[_]]=_;return{glog:function(u){if(u<1)throw"glog("+u+")";return f[u]},gexp:function(u){for(;u<0;)u+=255;for(;u>=256;)u-=255;return p[u]}}}();function ft(p,f){if(p.length===void 0)throw p.length+"/"+f;var _=function(){for(var h=0;h<p.length&&p[h]==0;)h+=1;for(var m=new Array(p.length-h+f),y=0;y<p.length-h;y+=1)m[y]=p[y+h];return m}(),u={getAt:function(h){return _[h]},getLength:function(){return _.length},multiply:function(h){for(var m=new Array(u.getLength()+h.getLength()-1),y=0;y<u.getLength();y+=1)for(var v=0;v<h.getLength();v+=1)m[y+v]^=lt.gexp(lt.glog(u.getAt(y))+lt.glog(h.getAt(v)));return ft(m,0)},mod:function(h){if(u.getLength()-h.getLength()<0)return u;for(var m=lt.glog(u.getAt(0))-lt.glog(h.getAt(0)),y=new Array(u.getLength()),v=0;v<u.getLength();v+=1)y[v]=u.getAt(v);for(v=0;v<h.getLength();v+=1)y[v]^=lt.gexp(lt.glog(h.getAt(v))+m);return ft(y,0).mod(h)}};return u}var B=function(){var p=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],f=function(u,h){var m={};return m.totalCount=u,m.dataCount=h,m},_={getRSBlocks:function(u,h){var m=function(t,o){switch(o){case pt.L:return p[4*(t-1)+0];case pt.M:return p[4*(t-1)+1];case pt.Q:return p[4*(t-1)+2];case pt.H:return p[4*(t-1)+3];default:return}}(u,h);if(m===void 0)throw"bad rs block @ typeNumber:"+u+"/errorCorrectionLevel:"+h;for(var y=m.length/3,v=[],x=0;x<y;x+=1)for(var G=m[3*x+0],X=m[3*x+1],M=m[3*x+2],e=0;e<G;e+=1)v.push(f(X,M));return v}};return _}(),dt=function(){var p=[],f=0,_={getBuffer:function(){return p},getAt:function(u){var h=Math.floor(u/8);return(p[h]>>>7-u%8&1)==1},put:function(u,h){for(var m=0;m<h;m+=1)_.putBit((u>>>h-m-1&1)==1)},getLengthInBits:function(){return f},putBit:function(u){var h=Math.floor(f/8);p.length<=h&&p.push(0),u&&(p[h]|=128>>>f%8),f+=1}};return _},mt=function(p){var f=p,_={getMode:function(){return 1},getLength:function(m){return f.length},write:function(m){for(var y=f,v=0;v+2<y.length;)m.put(u(y.substring(v,v+3)),10),v+=3;v<y.length&&(y.length-v==1?m.put(u(y.substring(v,v+1)),4):y.length-v==2&&m.put(u(y.substring(v,v+2)),7))}},u=function(m){for(var y=0,v=0;v<m.length;v+=1)y=10*y+h(m.charAt(v));return y},h=function(m){if("0"<=m&&m<="9")return m.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+m};return _},wt=function(p){var f=p,_={getMode:function(){return 2},getLength:function(h){return f.length},write:function(h){for(var m=f,y=0;y+1<m.length;)h.put(45*u(m.charAt(y))+u(m.charAt(y+1)),11),y+=2;y<m.length&&h.put(u(m.charAt(y)),6)}},u=function(h){if("0"<=h&&h<="9")return h.charCodeAt(0)-"0".charCodeAt(0);if("A"<=h&&h<="Z")return h.charCodeAt(0)-"A".charCodeAt(0)+10;switch(h){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+h}};return _},Ot=function(p){var f=T.stringToBytes(p);return{getMode:function(){return 4},getLength:function(_){return f.length},write:function(_){for(var u=0;u<f.length;u+=1)_.put(f[u],8)}}},Ct=function(p){var f=T.stringToBytesFuncs.SJIS;if(!f)throw"sjis not supported.";(function(h,m){var y=f("友");if(y.length!=2||(y[0]<<8|y[1])!=38726)throw"sjis not supported."})();var _=f(p),u={getMode:function(){return 8},getLength:function(h){return~~(_.length/2)},write:function(h){for(var m=_,y=0;y+1<m.length;){var v=(255&m[y])<<8|255&m[y+1];if(33088<=v&&v<=40956)v-=33088;else{if(!(57408<=v&&v<=60351))throw"illegal char at "+(y+1)+"/"+v;v-=49472}v=192*(v>>>8&255)+(255&v),h.put(v,13),y+=2}if(y<m.length)throw"illegal char at "+(y+1)}};return u},zt=function(){var p=[],f={writeByte:function(_){p.push(255&_)},writeShort:function(_){f.writeByte(_),f.writeByte(_>>>8)},writeBytes:function(_,u,h){u=u||0,h=h||_.length;for(var m=0;m<h;m+=1)f.writeByte(_[m+u])},writeString:function(_){for(var u=0;u<_.length;u+=1)f.writeByte(_.charCodeAt(u))},toByteArray:function(){return p},toString:function(){var _="";_+="[";for(var u=0;u<p.length;u+=1)u>0&&(_+=","),_+=p[u];return _+"]"}};return f},kt=function(p){var f=p,_=0,u=0,h=0,m={read:function(){for(;h<8;){if(_>=f.length){if(h==0)return-1;throw"unexpected end of file./"+h}var v=f.charAt(_);if(_+=1,v=="=")return h=0,-1;v.match(/^\s$/)||(u=u<<6|y(v.charCodeAt(0)),h+=6)}var x=u>>>h-8&255;return h-=8,x}},y=function(v){if(65<=v&&v<=90)return v-65;if(97<=v&&v<=122)return v-97+26;if(48<=v&&v<=57)return v-48+52;if(v==43)return 62;if(v==47)return 63;throw"c:"+v};return m},vt=function(p,f,_){for(var u=function(X,M){var e=X,t=M,o=new Array(X*M),n={setPixel:function(r,s,c){o[s*e+r]=c},write:function(r){r.writeString("GIF87a"),r.writeShort(e),r.writeShort(t),r.writeByte(128),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(0),r.writeByte(255),r.writeByte(255),r.writeByte(255),r.writeString(","),r.writeShort(0),r.writeShort(0),r.writeShort(e),r.writeShort(t),r.writeByte(0);var s=i(2);r.writeByte(2);for(var c=0;s.length-c>255;)r.writeByte(255),r.writeBytes(s,c,255),c+=255;r.writeByte(s.length-c),r.writeBytes(s,c,s.length-c),r.writeByte(0),r.writeString(";")}},i=function(r){for(var s=1<<r,c=1+(1<<r),l=r+1,d=a(),g=0;g<s;g+=1)d.add(String.fromCharCode(g));d.add(String.fromCharCode(s)),d.add(String.fromCharCode(c));var w,b,C,O=zt(),z=(w=O,b=0,C=0,{write:function(j,D){if(j>>>D)throw"length over";for(;b+D>=8;)w.writeByte(255&(j<<b|C)),D-=8-b,j>>>=8-b,C=0,b=0;C|=j<<b,b+=D},flush:function(){b>0&&w.writeByte(C)}});z.write(s,l);var Y=0,Q=String.fromCharCode(o[Y]);for(Y+=1;Y<o.length;){var V=String.fromCharCode(o[Y]);Y+=1,d.contains(Q+V)?Q+=V:(z.write(d.indexOf(Q),l),d.size()<4095&&(d.size()==1<<l&&(l+=1),d.add(Q+V)),Q=V)}return z.write(d.indexOf(Q),l),z.write(c,l),z.flush(),O.toByteArray()},a=function(){var r={},s=0,c={add:function(l){if(c.contains(l))throw"dup key:"+l;r[l]=s,s+=1},size:function(){return s},indexOf:function(l){return r[l]},contains:function(l){return r[l]!==void 0}};return c};return n}(p,f),h=0;h<f;h+=1)for(var m=0;m<p;m+=1)u.setPixel(m,h,_(m,h));var y=zt();u.write(y);for(var v=function(){var X=0,M=0,e=0,t="",o={},n=function(a){t+=String.fromCharCode(i(63&a))},i=function(a){if(!(a<0)){if(a<26)return 65+a;if(a<52)return a-26+97;if(a<62)return a-52+48;if(a==62)return 43;if(a==63)return 47}throw"n:"+a};return o.writeByte=function(a){for(X=X<<8|255&a,M+=8,e+=1;M>=6;)n(X>>>M-6),M-=6},o.flush=function(){if(M>0&&(n(X<<6-M),X=0,M=0),e%3!=0)for(var a=3-e%3,r=0;r<a;r+=1)t+="="},o.toString=function(){return t},o}(),x=y.toByteArray(),G=0;G<x.length;G+=1)v.writeByte(x[G]);return v.flush(),"data:image/gif;base64,"+v};return T}();_t.stringToBytesFuncs["UTF-8"]=function(T){return function(ht){for(var et=[],ot=0;ot<ht.length;ot++){var R=ht.charCodeAt(ot);R<128?et.push(R):R<2048?et.push(192|R>>6,128|63&R):R<55296||R>=57344?et.push(224|R>>12,128|R>>6&63,128|63&R):(ot++,R=65536+((1023&R)<<10|1023&ht.charCodeAt(ot)),et.push(240|R>>18,128|R>>12&63,128|R>>6&63,128|63&R))}return et}(T)},(P=typeof(k=function(){return _t})=="function"?k.apply(N,[]):k)===void 0||(F.exports=P)}},S={};function W(F){var N=S[F];if(N!==void 0)return N.exports;var k=S[F]={exports:{}};return bt[F](k,k.exports,W),k.exports}W.n=F=>{var N=F&&F.__esModule?()=>F.default:()=>F;return W.d(N,{a:N}),N},W.d=(F,N)=>{for(var k in N)W.o(N,k)&&!W.o(F,k)&&Object.defineProperty(F,k,{enumerable:!0,get:N[k]})},W.o=(F,N)=>Object.prototype.hasOwnProperty.call(F,N);var U={};return(()=>{W.d(U,{default:()=>X});const F=M=>!!M&&typeof M=="object"&&!Array.isArray(M);function N(M,...e){if(!e.length)return M;const t=e.shift();return t!==void 0&&F(M)&&F(t)?(M=Object.assign({},M),Object.keys(t).forEach(o=>{const n=M[o],i=t[o];Array.isArray(n)&&Array.isArray(i)?M[o]=i:F(n)&&F(i)?M[o]=N(Object.assign({},n),i):M[o]=i}),N(M,...e)):M}function k(M,e){const t=document.createElement("a");t.download=e,t.href=M,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function P({originalHeight:M,originalWidth:e,maxHiddenDots:t,maxHiddenAxisDots:o,dotSize:n}){const i={x:0,y:0},a={x:0,y:0};if(M<=0||e<=0||t<=0||n<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};const r=M/e;return i.x=Math.floor(Math.sqrt(t/r)),i.x<=0&&(i.x=1),o&&o<i.x&&(i.x=o),i.x%2==0&&i.x--,a.x=i.x*n,i.y=1+2*Math.ceil((i.x*r-1)/2),a.y=Math.round(a.x*r),(i.y*i.x>t||o&&o<i.y)&&(o&&o<i.y?(i.y=o,i.y%2==0&&i.x--):i.y-=2,a.y=i.y*n,i.x=1+2*Math.ceil((i.y/r-1)/2),a.x=Math.round(a.y/r)),{height:a.y,width:a.x,hideYDots:i.x,hideXDots:i.y}}const _t={L:.07,M:.15,Q:.25,H:.3},T="dots",ht="rounded",et="classy",ot="classy-rounded",R="extra-rounded";class J{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const i=this._context;let a;switch(this._type){case T:a=this._drawDot;break;case et:a=this._drawClassy;break;case ot:a=this._drawClassyRounded;break;case ht:a=this._drawRounded;break;case R:a=this._drawExtraRounded;break;default:a=this._drawSquare}a.call(this,{x:e,y:t,size:o,context:i,getNeighbor:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:i=0,draw:a}){const r=e+o/2,s=t+o/2;n.translate(r,s),i&&n.rotate(i),a(),n.closePath(),i&&n.rotate(-i),n.translate(-r,-s)}_basicDot(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t)}}))}_basicSideRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,Math.PI/2),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornerRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,0),o.lineTo(t/2,t/2),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornerExtraRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-t/2,t/2,t,-Math.PI/2,0),o.lineTo(-t/2,t/2),o.lineTo(-t/2,-t/2)}}))}_basicCornersRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,-Math.PI/2,0),o.lineTo(t/2,t/2),o.lineTo(0,t/2),o.arc(0,0,t/2,Math.PI/2,Math.PI),o.lineTo(-t/2,-t/2),o.lineTo(0,-t/2)}}))}_basicCornersExtraRounded(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-t/2,t/2,t,-Math.PI/2,0),o.arc(t/2,-t/2,t,Math.PI/2,Math.PI)}}))}_drawDot({x:e,y:t,size:o,context:n}){this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawSquare({x:e,y:t,size:o,context:n}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:0})}_drawRounded({x:e,y:t,size:o,context:n,getNeighbor:i}){const a=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,c=i?+i(0,1):0,l=a+r+s+c;if(l!==0)if(l>2||a&&r||s&&c)this._basicSquare({x:e,y:t,size:o,context:n,rotation:0});else{if(l===2){let d=0;return a&&s?d=Math.PI/2:s&&r?d=Math.PI:r&&c&&(d=-Math.PI/2),void this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:d})}if(l===1){let d=0;return s?d=Math.PI/2:r?d=Math.PI:c&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,context:n,rotation:d})}}else this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawExtraRounded({x:e,y:t,size:o,context:n,getNeighbor:i}){const a=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,c=i?+i(0,1):0,l=a+r+s+c;if(l!==0)if(l>2||a&&r||s&&c)this._basicSquare({x:e,y:t,size:o,context:n,rotation:0});else{if(l===2){let d=0;return a&&s?d=Math.PI/2:s&&r?d=Math.PI:r&&c&&(d=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:d})}if(l===1){let d=0;return s?d=Math.PI/2:r?d=Math.PI:c&&(d=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,context:n,rotation:d})}}else this._basicDot({x:e,y:t,size:o,context:n,rotation:0})}_drawClassy({x:e,y:t,size:o,context:n,getNeighbor:i}){const a=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,c=i?+i(0,1):0;a+r+s+c!==0?a||s?r||c?this._basicSquare({x:e,y:t,size:o,context:n,rotation:0}):this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:t,size:o,context:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2})}_drawClassyRounded({x:e,y:t,size:o,context:n,getNeighbor:i}){const a=i?+i(-1,0):0,r=i?+i(1,0):0,s=i?+i(0,-1):0,c=i?+i(0,1):0;a+r+s+c!==0?a||s?r||c?this._basicSquare({x:e,y:t,size:o,context:n,rotation:0}):this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:t,size:o,context:n,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,context:n,rotation:Math.PI/2})}}const pt="square",rt="extra-rounded";class lt{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const i=this._context;let a;switch(this._type){case pt:a=this._drawSquare;break;case rt:a=this._drawExtraRounded;break;default:a=this._drawDot}a.call(this,{x:e,y:t,size:o,context:i,rotation:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:i=0,draw:a}){const r=e+o/2,s=t+o/2;n.translate(r,s),i&&n.rotate(i),a(),n.closePath(),i&&n.rotate(-i),n.translate(-r,-s)}_basicDot(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI),o.arc(0,0,t/2-n,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t),o.rect(-t/2+n,-t/2+n,t-2*n,t-2*n)}}))}_basicExtraRounded(e){const{size:t,context:o}=e,n=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(-n,-n,2.5*n,Math.PI,-Math.PI/2),o.lineTo(n,-3.5*n),o.arc(n,-n,2.5*n,-Math.PI/2,0),o.lineTo(3.5*n,-n),o.arc(n,n,2.5*n,0,Math.PI/2),o.lineTo(-n,3.5*n),o.arc(-n,n,2.5*n,Math.PI/2,Math.PI),o.lineTo(-3.5*n,-n),o.arc(-n,-n,1.5*n,Math.PI,-Math.PI/2),o.lineTo(n,-2.5*n),o.arc(n,-n,1.5*n,-Math.PI/2,0),o.lineTo(2.5*n,-n),o.arc(n,n,1.5*n,0,Math.PI/2),o.lineTo(-n,2.5*n),o.arc(-n,n,1.5*n,Math.PI/2,Math.PI),o.lineTo(-2.5*n,-n)}}))}_drawDot({x:e,y:t,size:o,context:n,rotation:i}){this._basicDot({x:e,y:t,size:o,context:n,rotation:i})}_drawSquare({x:e,y:t,size:o,context:n,rotation:i}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:i})}_drawExtraRounded({x:e,y:t,size:o,context:n,rotation:i}){this._basicExtraRounded({x:e,y:t,size:o,context:n,rotation:i})}}const ft="square";class B{constructor({context:e,type:t}){this._context=e,this._type=t}draw(e,t,o,n){const i=this._context;let a;a=this._type===ft?this._drawSquare:this._drawDot,a.call(this,{x:e,y:t,size:o,context:i,rotation:n})}_rotateFigure({x:e,y:t,size:o,context:n,rotation:i=0,draw:a}){const r=e+o/2,s=t+o/2;n.translate(r,s),i&&n.rotate(i),a(),n.closePath(),i&&n.rotate(-i),n.translate(-r,-s)}_basicDot(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.arc(0,0,t/2,0,2*Math.PI)}}))}_basicSquare(e){const{size:t,context:o}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{o.rect(-t/2,-t/2,t,t)}}))}_drawDot({x:e,y:t,size:o,context:n,rotation:i}){this._basicDot({x:e,y:t,size:o,context:n,rotation:i})}_drawSquare({x:e,y:t,size:o,context:n,rotation:i}){this._basicSquare({x:e,y:t,size:o,context:n,rotation:i})}}const dt="radial",mt=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],wt=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class Ot{constructor(e){this._canvas=document.createElement("canvas"),this._canvas.width=e.width,this._canvas.height=e.height,this._options=e}get context(){return this._canvas.getContext("2d")}get width(){return this._canvas.width}get height(){return this._canvas.height}getCanvas(){return this._canvas}clear(){const e=this.context;e&&e.clearRect(0,0,this._canvas.width,this._canvas.height)}async drawQR(e){const t=e.getModuleCount(),o=Math.min(this._options.width,this._options.height)-2*this._options.margin,n=Math.floor(o/t);let i={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=e,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:a,qrOptions:r}=this._options,s=a.imageSize*_t[r.errorCorrectionLevel],c=Math.floor(s*t*t);i=P({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:c,maxHiddenAxisDots:t-14,dotSize:n})}this.clear(),this.drawBackground(),this.drawDots((a,r)=>{var s,c,l,d,g,w;return!(this._options.imageOptions.hideBackgroundDots&&a>=(t-i.hideXDots)/2&&a<(t+i.hideXDots)/2&&r>=(t-i.hideYDots)/2&&r<(t+i.hideYDots)/2||!((s=mt[a])===null||s===void 0)&&s[r]||!((c=mt[a-t+7])===null||c===void 0)&&c[r]||!((l=mt[a])===null||l===void 0)&&l[r-t+7]||!((d=wt[a])===null||d===void 0)&&d[r]||!((g=wt[a-t+7])===null||g===void 0)&&g[r]||!((w=wt[a])===null||w===void 0)&&w[r-t+7])}),this.drawCorners(),this._options.image&&this.drawImage({width:i.width,height:i.height,count:t,dotSize:n})}drawBackground(){const e=this.context,t=this._options;if(e){if(t.backgroundOptions.gradient){const o=t.backgroundOptions.gradient,n=this._createGradient({context:e,options:o,additionalRotation:0,x:0,y:0,size:this._canvas.width>this._canvas.height?this._canvas.width:this._canvas.height});o.colorStops.forEach(({offset:i,color:a})=>{n.addColorStop(i,a)}),e.fillStyle=n}else t.backgroundOptions.color&&(e.fillStyle=t.backgroundOptions.color);e.fillRect(0,0,this._canvas.width,this._canvas.height)}}drawDots(e){if(!this._qr)throw"QR code is not defined";const t=this.context;if(!t)throw"QR code is not defined";const o=this._options,n=this._qr.getModuleCount();if(n>o.width||n>o.height)throw"The canvas is too small.";const i=Math.min(o.width,o.height)-2*o.margin,a=Math.floor(i/n),r=Math.floor((o.width-n*a)/2),s=Math.floor((o.height-n*a)/2),c=new J({context:t,type:o.dotsOptions.type});t.beginPath();for(let l=0;l<n;l++)for(let d=0;d<n;d++){if(e&&!e(l,d)||!this._qr.isDark(l,d))continue;const g=this._options.useLegacyDotRotation?r+l*a:s+d*a,w=this._options.useLegacyDotRotation?s+d*a:r+l*a;c.draw(g,w,a,(b,C)=>this._options.useLegacyDotRotation?!(l+b<0||d+C<0||l+b>=n||d+C>=n)&&!(e&&!e(l+b,d+C))&&!!this._qr&&this._qr.isDark(l+b,d+C):!(d+b<0||l+C<0||d+b>=n||l+C>=n)&&!(e&&!e(d+b,l+C))&&!!this._qr&&this._qr.isDark(l+C,d+b))}if(o.dotsOptions.gradient){const l=o.dotsOptions.gradient,d=this._createGradient({context:t,options:l,additionalRotation:0,x:r,y:s,size:n*a});l.colorStops.forEach(({offset:g,color:w})=>{d.addColorStop(g,w)}),t.fillStyle=t.strokeStyle=d}else o.dotsOptions.color&&(t.fillStyle=t.strokeStyle=o.dotsOptions.color);t.fill("evenodd")}drawCorners(e){if(!this._qr)throw"QR code is not defined";const t=this.context;if(!t)throw"QR code is not defined";const o=this._options,n=this._qr.getModuleCount(),i=Math.min(o.width,o.height)-2*o.margin,a=Math.floor(i/n),r=7*a,s=3*a,c=Math.floor((o.width-n*a)/2),l=Math.floor((o.height-n*a)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([d,g,w])=>{var b,C,O,z,Y,Q,V,j,D,nt;if(e&&!e(d,g))return;const tt=c+d*a*(n-7),q=l+g*a*(n-7);if(!((b=o.cornersSquareOptions)===null||b===void 0)&&b.type){const L=new lt({context:t,type:(C=o.cornersSquareOptions)===null||C===void 0?void 0:C.type});t.beginPath(),L.draw(tt,q,r,w)}else{const L=new J({context:t,type:o.dotsOptions.type});t.beginPath();for(let I=0;I<mt.length;I++)for(let E=0;E<mt[I].length;E++)!((O=mt[I])===null||O===void 0)&&O[E]&&L.draw(tt+I*a,q+E*a,a,(Z,K)=>{var $;return!!(!(($=mt[I+Z])===null||$===void 0)&&$[E+K])})}if(!((z=o.cornersSquareOptions)===null||z===void 0)&&z.gradient){const L=o.cornersSquareOptions.gradient,I=this._createGradient({context:t,options:L,additionalRotation:w,x:tt,y:q,size:r});L.colorStops.forEach(({offset:E,color:Z})=>{I.addColorStop(E,Z)}),t.fillStyle=t.strokeStyle=I}else!((Y=o.cornersSquareOptions)===null||Y===void 0)&&Y.color&&(t.fillStyle=t.strokeStyle=o.cornersSquareOptions.color);if(t.fill("evenodd"),(Q=o.cornersDotOptions)===null||Q===void 0?void 0:Q.type){const L=new B({context:t,type:(V=o.cornersDotOptions)===null||V===void 0?void 0:V.type});t.beginPath(),L.draw(tt+2*a,q+2*a,s,w)}else{const L=new J({context:t,type:o.dotsOptions.type});t.beginPath();for(let I=0;I<wt.length;I++)for(let E=0;E<wt[I].length;E++)!((j=wt[I])===null||j===void 0)&&j[E]&&L.draw(tt+I*a,q+E*a,a,(Z,K)=>{var $;return!!(!(($=wt[I+Z])===null||$===void 0)&&$[E+K])})}if(!((D=o.cornersDotOptions)===null||D===void 0)&&D.gradient){const L=o.cornersDotOptions.gradient,I=this._createGradient({context:t,options:L,additionalRotation:w,x:tt+2*a,y:q+2*a,size:s});L.colorStops.forEach(({offset:E,color:Z})=>{I.addColorStop(E,Z)}),t.fillStyle=t.strokeStyle=I}else!((nt=o.cornersDotOptions)===null||nt===void 0)&&nt.color&&(t.fillStyle=t.strokeStyle=o.cornersDotOptions.color);t.fill("evenodd")})}loadImage(){return new Promise((e,t)=>{const o=this._options,n=new Image;if(!o.image)return t("Image is not defined");typeof o.imageOptions.crossOrigin=="string"&&(n.crossOrigin=o.imageOptions.crossOrigin),this._image=n,n.onload=()=>{e()},n.src=o.image})}drawImage({width:e,height:t,count:o,dotSize:n}){const i=this.context;if(!i)throw"canvasContext is not defined";if(!this._image)throw"image is not defined";const a=this._options,r=Math.floor((a.width-o*n)/2),s=Math.floor((a.height-o*n)/2),c=r+a.imageOptions.margin+(o*n-e)/2,l=s+a.imageOptions.margin+(o*n-t)/2,d=e-2*a.imageOptions.margin,g=t-2*a.imageOptions.margin;i.drawImage(this._image,c,l,d<0?0:d,g<0?0:g)}_createGradient({context:e,options:t,additionalRotation:o,x:n,y:i,size:a}){let r;if(t.type===dt)r=e.createRadialGradient(n+a/2,i+a/2,0,n+a/2,i+a/2,a/2);else{const s=((t.rotation||0)+o)%(2*Math.PI),c=(s+2*Math.PI)%(2*Math.PI);let l=n+a/2,d=i+a/2,g=n+a/2,w=i+a/2;c>=0&&c<=.25*Math.PI||c>1.75*Math.PI&&c<=2*Math.PI?(l-=a/2,d-=a/2*Math.tan(s),g+=a/2,w+=a/2*Math.tan(s)):c>.25*Math.PI&&c<=.75*Math.PI?(d-=a/2,l-=a/2/Math.tan(s),w+=a/2,g+=a/2/Math.tan(s)):c>.75*Math.PI&&c<=1.25*Math.PI?(l+=a/2,d+=a/2*Math.tan(s),g-=a/2,w-=a/2*Math.tan(s)):c>1.25*Math.PI&&c<=1.75*Math.PI&&(d+=a/2,l+=a/2/Math.tan(s),w-=a/2,g-=a/2/Math.tan(s)),r=e.createLinearGradient(Math.round(l),Math.round(d),Math.round(g),Math.round(w))}return r}}class Ct{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let i;switch(this._type){case T:i=this._drawDot;break;case et:i=this._drawClassy;break;case ot:i=this._drawClassyRounded;break;case ht:i=this._drawRounded;break;case R:i=this._drawExtraRounded;break;default:i=this._drawSquare}i.call(this,{x:e,y:t,size:o,getNeighbor:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:i}){var a;const r=e+o/2,s=t+o/2;i(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${r},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(o+t/2)),this._element.setAttribute("cy",String(n+t/2)),this._element.setAttribute("r",String(t/2))}}))}_basicSquare(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(o)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}}))}_basicSideRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h `+t/2+`a ${t/2} ${t/2}, 0, 0, 0, 0 ${-t}`)}}))}_basicCornerRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}v `+-t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}}))}_basicCornerExtraRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}a ${t} ${t}, 0, 0, 0, ${-t} ${-t}`)}}))}_basicCornersRounded(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("d",`M ${o} ${n}v `+t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${t/2} ${t/2}h `+t/2+"v "+-t/2+`a ${t/2} ${t/2}, 0, 0, 0, ${-t/2} ${-t/2}`)}}))}_drawDot({x:e,y:t,size:o}){this._basicDot({x:e,y:t,size:o,rotation:0})}_drawSquare({x:e,y:t,size:o}){this._basicSquare({x:e,y:t,size:o,rotation:0})}_drawRounded({x:e,y:t,size:o,getNeighbor:n}){const i=n?+n(-1,0):0,a=n?+n(1,0):0,r=n?+n(0,-1):0,s=n?+n(0,1):0,c=i+a+r+s;if(c!==0)if(c>2||i&&a||r&&s)this._basicSquare({x:e,y:t,size:o,rotation:0});else{if(c===2){let l=0;return i&&r?l=Math.PI/2:r&&a?l=Math.PI:a&&s&&(l=-Math.PI/2),void this._basicCornerRounded({x:e,y:t,size:o,rotation:l})}if(c===1){let l=0;return r?l=Math.PI/2:a?l=Math.PI:s&&(l=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,rotation:l})}}else this._basicDot({x:e,y:t,size:o,rotation:0})}_drawExtraRounded({x:e,y:t,size:o,getNeighbor:n}){const i=n?+n(-1,0):0,a=n?+n(1,0):0,r=n?+n(0,-1):0,s=n?+n(0,1):0,c=i+a+r+s;if(c!==0)if(c>2||i&&a||r&&s)this._basicSquare({x:e,y:t,size:o,rotation:0});else{if(c===2){let l=0;return i&&r?l=Math.PI/2:r&&a?l=Math.PI:a&&s&&(l=-Math.PI/2),void this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:l})}if(c===1){let l=0;return r?l=Math.PI/2:a?l=Math.PI:s&&(l=-Math.PI/2),void this._basicSideRounded({x:e,y:t,size:o,rotation:l})}}else this._basicDot({x:e,y:t,size:o,rotation:0})}_drawClassy({x:e,y:t,size:o,getNeighbor:n}){const i=n?+n(-1,0):0,a=n?+n(1,0):0,r=n?+n(0,-1):0,s=n?+n(0,1):0;i+a+r+s!==0?i||r?a||s?this._basicSquare({x:e,y:t,size:o,rotation:0}):this._basicCornerRounded({x:e,y:t,size:o,rotation:Math.PI/2}):this._basicCornerRounded({x:e,y:t,size:o,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,rotation:Math.PI/2})}_drawClassyRounded({x:e,y:t,size:o,getNeighbor:n}){const i=n?+n(-1,0):0,a=n?+n(1,0):0,r=n?+n(0,-1):0,s=n?+n(0,1):0;i+a+r+s!==0?i||r?a||s?this._basicSquare({x:e,y:t,size:o,rotation:0}):this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:e,y:t,size:o,rotation:-Math.PI/2}):this._basicCornersRounded({x:e,y:t,size:o,rotation:Math.PI/2})}}class zt{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let i;switch(this._type){case pt:i=this._drawSquare;break;case rt:i=this._drawExtraRounded;break;default:i=this._drawDot}i.call(this,{x:e,y:t,size:o,rotation:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:i}){var a;const r=e+o/2,s=t+o/2;i(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${r},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e,i=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o+t/2} ${n}a ${t/2} ${t/2} 0 1 0 0.1 0zm 0 ${i}a ${t/2-i} ${t/2-i} 0 1 1 -0.1 0Z`)}}))}_basicSquare(e){const{size:t,x:o,y:n}=e,i=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o} ${n}v ${t}h ${t}v `+-t+`zM ${o+i} ${n+i}h `+(t-2*i)+"v "+(t-2*i)+"h "+(2*i-t)+"z")}}))}_basicExtraRounded(e){const{size:t,x:o,y:n}=e,i=t/7;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","path"),this._element.setAttribute("clip-rule","evenodd"),this._element.setAttribute("d",`M ${o} ${n+2.5*i}v `+2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*i} ${2.5*i}h `+2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*i} ${2.5*-i}v `+-2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*-i} ${2.5*-i}h `+-2*i+`a ${2.5*i} ${2.5*i}, 0, 0, 0, ${2.5*-i} ${2.5*i}M ${o+2.5*i} ${n+i}h `+2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*i} ${1.5*i}v `+2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*-i} ${1.5*i}h `+-2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*-i} ${1.5*-i}v `+-2*i+`a ${1.5*i} ${1.5*i}, 0, 0, 1, ${1.5*i} ${1.5*-i}`)}}))}_drawDot({x:e,y:t,size:o,rotation:n}){this._basicDot({x:e,y:t,size:o,rotation:n})}_drawSquare({x:e,y:t,size:o,rotation:n}){this._basicSquare({x:e,y:t,size:o,rotation:n})}_drawExtraRounded({x:e,y:t,size:o,rotation:n}){this._basicExtraRounded({x:e,y:t,size:o,rotation:n})}}class kt{constructor({svg:e,type:t}){this._svg=e,this._type=t}draw(e,t,o,n){let i;i=this._type===ft?this._drawSquare:this._drawDot,i.call(this,{x:e,y:t,size:o,rotation:n})}_rotateFigure({x:e,y:t,size:o,rotation:n=0,draw:i}){var a;const r=e+o/2,s=t+o/2;i(),(a=this._element)===null||a===void 0||a.setAttribute("transform",`rotate(${180*n/Math.PI},${r},${s})`)}_basicDot(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._element.setAttribute("cx",String(o+t/2)),this._element.setAttribute("cy",String(n+t/2)),this._element.setAttribute("r",String(t/2))}}))}_basicSquare(e){const{size:t,x:o,y:n}=e;this._rotateFigure(Object.assign(Object.assign({},e),{draw:()=>{this._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._element.setAttribute("x",String(o)),this._element.setAttribute("y",String(n)),this._element.setAttribute("width",String(t)),this._element.setAttribute("height",String(t))}}))}_drawDot({x:e,y:t,size:o,rotation:n}){this._basicDot({x:e,y:t,size:o,rotation:n})}_drawSquare({x:e,y:t,size:o,rotation:n}){this._basicSquare({x:e,y:t,size:o,rotation:n})}}const vt=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],p=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];class f{constructor(e){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(e.width)),this._element.setAttribute("height",String(e.height)),this._element.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._style=document.createElementNS("http://www.w3.org/2000/svg","style"),this._options=e}get width(){return this._options.width}get height(){return this._options.height}getElement(){return this._element}clear(){var e;const t=this._element;this._element=t.cloneNode(!1),(e=t==null?void 0:t.parentNode)===null||e===void 0||e.replaceChild(this._element,t),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._style=document.createElementNS("http://www.w3.org/2000/svg","style"),this._element.appendChild(this._style),this._element.appendChild(this._defs)}async drawQR(e){const t=e.getModuleCount(),o=Math.min(this._options.width,this._options.height)-2*this._options.margin,n=Math.floor(o/t);let i={hideXDots:0,hideYDots:0,width:0,height:0};if(this._qr=e,this._options.image){if(await this.loadImage(),!this._image)return;const{imageOptions:a,qrOptions:r}=this._options,s=a.imageSize*_t[r.errorCorrectionLevel],c=Math.floor(s*t*t);i=P({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:c,maxHiddenAxisDots:t-14,dotSize:n})}this._element.appendChild(this._style),this._element.appendChild(this._defs),this.clear(),this.drawBackground(),this.drawDots((a,r)=>{var s,c,l,d,g,w;return!(this._options.imageOptions.hideBackgroundDots&&a>=(t-i.hideXDots)/2&&a<(t+i.hideXDots)/2&&r>=(t-i.hideYDots)/2&&r<(t+i.hideYDots)/2||!((s=vt[a])===null||s===void 0)&&s[r]||!((c=vt[a-t+7])===null||c===void 0)&&c[r]||!((l=vt[a])===null||l===void 0)&&l[r-t+7]||!((d=p[a])===null||d===void 0)&&d[r]||!((g=p[a-t+7])===null||g===void 0)&&g[r]||!((w=p[a])===null||w===void 0)&&w[r-t+7])}),this.drawCorners(),this._options.image&&await this.drawImage({width:i.width,height:i.height,count:t,dotSize:n})}drawBackground(){var e,t,o;const n=this._element,i=this._options;if(n){const a=(e=i.backgroundOptions)===null||e===void 0?void 0:e.gradient,r=(t=i.backgroundOptions)===null||t===void 0?void 0:t.color;a?this._createColor({options:a,color:r,additionalRotation:0,x:0,y:0,height:i.height,width:i.width,name:"background-color"}):!((o=i.backgroundOptions)===null||o===void 0)&&o.color&&this._createStyle({color:r,name:"background-color"})}}drawDots(e){var t,o,n;if(!this._qr)throw"QR code is not defined";const i=this._options,a=this._qr.getModuleCount();if(a>i.width||a>i.height)throw"The canvas is too small.";const r=Math.min(i.width,i.height)-2*i.margin,s=Math.floor(r/a),c=Math.floor((i.width-a*s)/2),l=Math.floor((i.height-a*s)/2),d=new Ct({svg:this._element,type:i.dotsOptions.type});!((t=i.dotsOptions)===null||t===void 0)&&t.gradient?(this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:(o=i.dotsOptions)===null||o===void 0?void 0:o.gradient,color:i.dotsOptions.color,additionalRotation:0,x:c,y:l,height:a*s,width:a*s,name:"dot-color"})):i.dotsOptions.color&&(this._dots=document.createElementNS("http://www.w3.org/2000/svg","g"),this._dots.setAttribute("class","dot-color"),this._element.appendChild(this._dots),this._createStyle({color:i.dotsOptions.color,name:"dot-color"}));for(let g=0;g<a;g++)for(let w=0;w<a;w++){if(e&&!e(g,w)||!(!((n=this._qr)===null||n===void 0)&&n.isDark(g,w)))continue;const b=this._options.useLegacyDotRotation?c+g*s:l+w*s,C=this._options.useLegacyDotRotation?l+w*s:c+g*s;d.draw(b,C,s,(O,z)=>this._options.useLegacyDotRotation?!(g+O<0||w+z<0||g+O>=a||w+z>=a)&&!(e&&!e(g+O,w+z))&&!!this._qr&&this._qr.isDark(g+O,w+z):!(w+O<0||g+z<0||w+O>=a||g+z>=a)&&!(e&&!e(w+O,g+z))&&!!this._qr&&this._qr.isDark(g+z,w+O)),d._element&&this._dotsClipPath?this._dotsClipPath.appendChild(d._element):d._element&&this._dots&&this._dots.appendChild(d._element)}}drawCorners(){if(!this._qr)throw"QR code is not defined";const e=this._element,t=this._options;if(!e)throw"Element code is not defined";const o=this._qr.getModuleCount(),n=Math.min(t.width,t.height)-2*t.margin,i=Math.floor(n/o),a=7*i,r=3*i,s=Math.floor((t.width-o*i)/2),c=Math.floor((t.height-o*i)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach(([l,d,g])=>{var w,b,C,O,z,Y,Q,V,j,D,nt,tt,q,L;const I=s+l*i*(o-7),E=c+d*i*(o-7);let Z=this._dotsClipPath,K=this._dotsClipPath;if(!((w=t.cornersSquareOptions)===null||w===void 0)&&w.gradient?(Z=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),Z.setAttribute("id",`clip-path-corners-square-color-${l}-${d}`),this._defs.appendChild(Z),this._cornersSquareClipPath=this._cornersDotClipPath=K=Z,this._createColor({options:(b=t.cornersSquareOptions)===null||b===void 0?void 0:b.gradient,color:(C=t.cornersSquareOptions)===null||C===void 0?void 0:C.color,additionalRotation:g,x:I,y:E,height:a,width:a,name:`corners-square-color-${l}-${d}`})):(this._cornerSquares=document.createElementNS("http://www.w3.org/2000/svg","g"),this._cornerSquares.setAttribute("class",`corners-square-color-${l}-${d}`),this._element.appendChild(this._cornerSquares),this._createStyle({color:(O=t.cornersSquareOptions)===null||O===void 0?void 0:O.color,name:`corners-square-color-${l}-${d}`})),(z=t.cornersSquareOptions)===null||z===void 0?void 0:z.type){const $=new zt({svg:this._element,type:t.cornersSquareOptions.type});$.draw(I,E,a,g),!((Y=t.cornersSquareOptions)===null||Y===void 0)&&Y.gradient&&$._element&&Z?Z.appendChild($._element):$._element&&this._cornerSquares&&this._cornerSquares.appendChild($._element)}else{const $=new Ct({svg:this._element,type:t.dotsOptions.type});for(let at=0;at<vt.length;at++)for(let ut=0;ut<vt[at].length;ut++)!((Q=vt[at])===null||Q===void 0)&&Q[ut]&&($.draw(I+at*i,E+ut*i,i,(Rt,Bt)=>{var xt;return!!(!((xt=vt[at+Rt])===null||xt===void 0)&&xt[ut+Bt])}),$._element&&this._cornersSquareClipPath?this._cornersSquareClipPath.appendChild($._element):$._element&&this._cornerSquares&&this._cornerSquares.appendChild($._element))}if(!((V=t.cornersDotOptions)===null||V===void 0)&&V.gradient?(K=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),K.setAttribute("id",`clip-path-corners-dot-color-${l}-${d}`),this._defs.appendChild(K),this._cornersDotClipPath=K,this._createColor({options:(j=t.cornersDotOptions)===null||j===void 0?void 0:j.gradient,color:(D=t.cornersDotOptions)===null||D===void 0?void 0:D.color,additionalRotation:g,x:I+2*i,y:E+2*i,height:r,width:r,name:`corners-dot-color-${l}-${d}`})):(this._cornerDots=document.createElementNS("http://www.w3.org/2000/svg","g"),this._cornerDots.setAttribute("class",`corners-dot-color-${l}-${d}`),this._element.appendChild(this._cornerDots),this._createStyle({color:(nt=t.cornersDotOptions)===null||nt===void 0?void 0:nt.color,name:`corners-dot-color-${l}-${d}`})),(tt=t.cornersDotOptions)===null||tt===void 0?void 0:tt.type){const $=new kt({svg:this._element,type:t.cornersDotOptions.type});$.draw(I+2*i,E+2*i,r,g),!((q=t.cornersDotOptions)===null||q===void 0)&&q.gradient&&$._element&&K?K.appendChild($._element):$._element&&this._cornerDots&&this._cornerDots.appendChild($._element)}else{const $=new Ct({svg:this._element,type:t.dotsOptions.type});for(let at=0;at<p.length;at++)for(let ut=0;ut<p[at].length;ut++)!((L=p[at])===null||L===void 0)&&L[ut]&&($.draw(I+at*i,E+ut*i,i,(Rt,Bt)=>{var xt;return!!(!((xt=p[at+Rt])===null||xt===void 0)&&xt[ut+Bt])}),$._element&&this._cornersDotClipPath?this._cornersDotClipPath.appendChild($._element):$._element&&this._cornerDots&&this._cornerDots.appendChild($._element))}})}loadImage(){return new Promise((e,t)=>{const o=this._options,n=new Image;if(!o.image)return t("Image is not defined");typeof o.imageOptions.crossOrigin=="string"&&(n.crossOrigin=o.imageOptions.crossOrigin),this._image=n,n.onload=()=>{e()},n.src=o.image})}async drawImage({width:e,height:t,count:o,dotSize:n}){const i=this._options,a=Math.floor((i.width-o*n)/2),r=Math.floor((i.height-o*n)/2),s=a+i.imageOptions.margin+(o*n-e)/2,c=r+i.imageOptions.margin+(o*n-t)/2,l=e-2*i.imageOptions.margin,d=t-2*i.imageOptions.margin,g=document.createElementNS("http://www.w3.org/2000/svg","image"),w=await this._getBase64Image(i.image||"");g.setAttribute("href",w),g.setAttribute("xlink:href",w),g.setAttribute("x",String(s)),g.setAttribute("y",String(c)),g.setAttribute("width",`${l}px`),g.setAttribute("height",`${d}px`),this._element.appendChild(g)}async _getImageBlob(e){return(await fetch(e)).blob()}_blobToBase64(e){return new Promise(t=>{const o=new FileReader;o.onload=function(){const n=o.result;t(n)},o.readAsDataURL(e)})}async _getBase64Image(e){if(e==="")return new Promise(o=>{o("")});const t=await this._getImageBlob(e);return await this._blobToBase64(t)}_createColor({options:e,color:t,additionalRotation:o,x:n,y:i,height:a,width:r,name:s}){const c=r>a?r:a,l=document.createElementNS("http://www.w3.org/2000/svg","rect");if(l.setAttribute("x",String(n)),l.setAttribute("y",String(i)),l.setAttribute("height",String(a)),l.setAttribute("width",String(r)),l.setAttribute("clip-path",`url('#clip-path-${s}')`),e){let d;if(e.type===dt)d=document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),d.setAttribute("id",s),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("fx",String(n+r/2)),d.setAttribute("fy",String(i+a/2)),d.setAttribute("cx",String(n+r/2)),d.setAttribute("cy",String(i+a/2)),d.setAttribute("r",String(c/2));else{const g=((e.rotation||0)+o)%(2*Math.PI),w=(g+2*Math.PI)%(2*Math.PI);let b=n+r/2,C=i+a/2,O=n+r/2,z=i+a/2;w>=0&&w<=.25*Math.PI||w>1.75*Math.PI&&w<=2*Math.PI?(b-=r/2,C-=a/2*Math.tan(g),O+=r/2,z+=a/2*Math.tan(g)):w>.25*Math.PI&&w<=.75*Math.PI?(C-=a/2,b-=r/2/Math.tan(g),z+=a/2,O+=r/2/Math.tan(g)):w>.75*Math.PI&&w<=1.25*Math.PI?(b+=r/2,C+=a/2*Math.tan(g),O-=r/2,z-=a/2*Math.tan(g)):w>1.25*Math.PI&&w<=1.75*Math.PI&&(C+=a/2,b+=r/2/Math.tan(g),z-=a/2,O-=r/2/Math.tan(g)),d=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),d.setAttribute("id",s),d.setAttribute("gradientUnits","userSpaceOnUse"),d.setAttribute("x1",String(Math.round(b))),d.setAttribute("y1",String(Math.round(C))),d.setAttribute("x2",String(Math.round(O))),d.setAttribute("y2",String(Math.round(z)))}e.colorStops.forEach(({offset:g,color:w})=>{const b=document.createElementNS("http://www.w3.org/2000/svg","stop");b.setAttribute("offset",100*g+"%"),b.setAttribute("stop-color",w),d.appendChild(b)}),l.setAttribute("fill",`url('#${s}')`),this._defs.appendChild(d)}else t&&l.setAttribute("fill",t);this._element.appendChild(l)}_createStyle({color:e,name:t}){this._style.innerHTML+=`.${t}{ fill: ${e}; }`}}const _="canvas",u={};for(let M=0;M<=40;M++)u[M]=M;const h={type:_,width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:u[0],mode:void 0,errorCorrectionLevel:"Q",multibyte:"default"},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:"anonymous",margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{color:"#fff"},useLegacyDotRotation:!1};function m(M){const e=Object.assign({},M);if(!e.colorStops||!e.colorStops.length)throw"Field 'colorStops' is required in gradient";return e.rotation?e.rotation=Number(e.rotation):e.rotation=0,e.colorStops=e.colorStops.map(t=>Object.assign(Object.assign({},t),{offset:Number(t.offset)})),e}function y(M){const e=Object.assign({},M);return e.width=Number(e.width),e.height=Number(e.height),e.margin=Number(e.margin),e.imageOptions=Object.assign(Object.assign({},e.imageOptions),{hideBackgroundDots:!!e.imageOptions.hideBackgroundDots,imageSize:Number(e.imageOptions.imageSize),margin:Number(e.imageOptions.margin)}),e.margin>Math.min(e.width,e.height)&&(e.margin=Math.min(e.width,e.height)),e.dotsOptions=Object.assign({},e.dotsOptions),e.dotsOptions.gradient&&(e.dotsOptions.gradient=m(e.dotsOptions.gradient)),e.cornersSquareOptions&&(e.cornersSquareOptions=Object.assign({},e.cornersSquareOptions),e.cornersSquareOptions.gradient&&(e.cornersSquareOptions.gradient=m(e.cornersSquareOptions.gradient))),e.cornersDotOptions&&(e.cornersDotOptions=Object.assign({},e.cornersDotOptions),e.cornersDotOptions.gradient&&(e.cornersDotOptions.gradient=m(e.cornersDotOptions.gradient))),e.backgroundOptions&&(e.backgroundOptions=Object.assign({},e.backgroundOptions),e.backgroundOptions.gradient&&(e.backgroundOptions.gradient=m(e.backgroundOptions.gradient))),e}var v=W(192),x=W.n(v);class G{constructor(e){this._options=e?y(N(h,e)):h,this.update()}static _clearContainer(e){e&&(e.innerHTML="")}async _getQRStylingElement(e){if(!this._qr)throw"QR code is empty";if(e.toLowerCase()==="svg"){let t,o;return this._svg&&this._svgDrawingPromise?(o=this._svg,t=this._svgDrawingPromise):(o=new f(this._options),t=o.drawQR(this._qr)),await t,o}{let t,o;return this._canvas&&this._canvasDrawingPromise?(o=this._canvas,t=this._canvasDrawingPromise):(o=new Ot(this._options),t=o.drawQR(this._qr)),await t,o}}update(e){G._clearContainer(this._container),this._options=e?y(N(this._options,e)):this._options,this._options.data&&(x().stringToBytes=x().stringToBytesFuncs[this._options.qrOptions.multibyte],this._qr=x()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(t){switch(!0){case/^[0-9]*$/.test(t):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(t):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===_?(this._canvas=new Ot(this._options),this._canvasDrawingPromise=this._canvas.drawQR(this._qr),this._svgDrawingPromise=void 0,this._svg=void 0):(this._svg=new f(this._options),this._svgDrawingPromise=this._svg.drawQR(this._qr),this._canvasDrawingPromise=void 0,this._canvas=void 0),this.append(this._container))}append(e){if(e){if(typeof e.appendChild!="function")throw"Container should be a single DOM node";this._options.type===_?this._canvas&&e.appendChild(this._canvas.getCanvas()):this._svg&&e.appendChild(this._svg.getElement()),this._container=e}}async getRawData(e="png",t){if(!this._qr)throw"QR code is empty";const o=e.toLocaleLowerCase();if(o==="svg"){const n=await this._getQRStylingElement(o),i=new XMLSerializer().serializeToString(n.getElement());return new Blob([`<?xml version="1.0" standalone="no"?>\r
`+i],{type:"image/svg+xml"})}{const n=await this._getQRStylingElement(o);return new Promise(i=>n.getCanvas().toBlob(i,`image/${o}`,t))}}async toDataUrl(e="png",t){if(!this._qr)throw"QR code is empty";const o=e.toLocaleLowerCase();return(await this._getQRStylingElement(o)).getCanvas().toDataURL(`image/${o}`,t)}async download(e){if(!this._qr)throw"QR code is empty";let t="png",o="qr";typeof e=="object"&&e!==null&&(e.name&&(o=e.name),e.extension&&(t=e.extension));const n=t.toLocaleLowerCase();if(n==="svg"){const i=await this._getQRStylingElement(n);let a=new XMLSerializer().serializeToString(i.getElement());a=`<?xml version="1.0" standalone="no"?>\r
`+a,k("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a),`${o}.svg`)}else k((await this._getQRStylingElement(n)).getCanvas().toDataURL(`image/${t}`),`${o}.${t}`)}}const X=G})(),U.default})())})(Nt);var oe=Nt.exports;const ne=Ht(oe),ie={key:0,class:"ctool-page-option",style:{"margin-top":"5px"}},ct="default",de=Vt({__name:"Generate",async setup(gt){let yt,bt;const S=Tt(([yt,bt]=Gt(()=>Ft({input:Zt(),option:te(),output:Jt("image")})),yt=await yt,bt(),yt));let W=jt(St.empty()),U=jt(St.empty());const F=async()=>{if(S.current.input.text.isError()){U.value=St.fromError(S.current.input.text.toString());return}if(U.value=St.empty(),!S.current.input.text.isEmpty())try{const P=await new ne(ee(S.current.option,S.current.input.text.toString(),W.value)).getRawData();if(!P)throw new Error("generated error");U.value=await St.fromBlob(P)}catch(k){U.value=St.fromError($error(k))}},N=async k=>{W.value=(await St.fromBlob(k)).setFileName(k.name)};return Xt(()=>({option:S.current.option,image:W.value,text:S.current.input.text}),()=>F(),{immediate:!0,deep:!0}),(k,P)=>{const _t=it("TextInput"),T=it("Bool"),ht=it("Display"),et=it("TextOutput"),ot=it("HeightResize"),R=it("InputNumber"),J=it("Select"),pt=it("UploadFile"),rt=it("Align"),lt=it("Tabs"),ft=Yt("row");return Mt(),Et(Lt,null,[Wt((Mt(),At(ot,{append:[".ctool-page-option"]},{default:st(({height:B})=>[H(ht,{position:"bottom-right"},{extra:st(()=>[A(U).isEmpty()||A(U).isError()?It("",!0):(Mt(),At(T,{key:0,size:"small",modelValue:A(S).current.option.is_show,"onUpdate:modelValue":P[1]||(P[1]=dt=>A(S).current.option.is_show=dt),label:k.$t("main_ui_setting"),border:""},null,8,["modelValue","label"]))]),default:st(()=>[H(_t,{modelValue:A(S).current.input,"onUpdate:modelValue":P[0]||(P[0]=dt=>A(S).current.input=dt),height:B,upload:"file"},null,8,["modelValue","height"])]),_:2},1024),H(et,{modelValue:A(S).current.output,"onUpdate:modelValue":P[2]||(P[2]=dt=>A(S).current.output=dt),allow:["image","hex","base64"],content:A(U),height:B,onSuccess:P[3]||(P[3]=dt=>A(S).save())},null,8,["modelValue","content","height"])]),_:1},8,["append"])),[[ft,"1-320px"]]),A(S).current.option.is_show?(Mt(),Et("div",ie,[H(lt,{modelValue:A(S).current.option.tab,"onUpdate:modelValue":P[15]||(P[15]=B=>A(S).current.option.tab=B),lists:[{label:k.$t("qrCode_generate_option_common"),name:"common"},{label:k.$t("qrCode_generate_option_content"),name:"content"},{label:k.$t("qrCode_generate_option_corners_square"),name:"corners_square"},{label:k.$t("qrCode_generate_option_corners_dot"),name:"corners_dot"},{label:k.$t("qrCode_generate_option_background"),name:"background"}]},{default:st(()=>[H(rt,null,{default:st(()=>[H(R,{size:ct,width:120,modelValue:A(S).current.option.margin,"onUpdate:modelValue":P[4]||(P[4]=B=>A(S).current.option.margin=B),max:1e3},{prepend:st(()=>[$t(qt(k.$t("qrCode_generate_option_margin")),1)]),_:1},8,["modelValue"]),H(J,{size:ct,options:["L","M","Q","H"],modelValue:A(S).current.option.error_correction_level,"onUpdate:modelValue":P[5]||(P[5]=B=>A(S).current.option.error_correction_level=B),label:k.$t("qrCode_generate_option_correction")},null,8,["modelValue","label"]),H(pt,{size:ct,onSuccess:N,"button-type":"text",type:"image"}),H(R,{size:ct,width:100,modelValue:A(S).current.option.image_options.size,"onUpdate:modelValue":P[6]||(P[6]=B=>A(S).current.option.image_options.size=B),max:10},{prepend:st(()=>[$t(qt(k.$t("qrCode_generate_option_size")),1)]),_:1},8,["modelValue"]),H(R,{size:ct,width:120,modelValue:A(S).current.option.image_options.margin,"onUpdate:modelValue":P[7]||(P[7]=B=>A(S).current.option.image_options.margin=B),max:1e3},{prepend:st(()=>[$t(qt(k.$t("qrCode_generate_option_margin")),1)]),_:1},8,["modelValue"])]),_:1}),H(Dt,{modelValue:A(S).current.option.dots_options.color,"onUpdate:modelValue":P[9]||(P[9]=B=>A(S).current.option.dots_options.color=B),size:ct},{default:st(()=>[H(J,{modelValue:A(S).current.option.dots_options.type,"onUpdate:modelValue":P[8]||(P[8]=B=>A(S).current.option.dots_options.type=B),options:A(Pt)(["square","dots","rounded","classy","extra-rounded","classy-rounded"],"qrCode_generate_option_"),size:ct,label:k.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),H(Dt,{modelValue:A(S).current.option.corners_square_options.color,"onUpdate:modelValue":P[11]||(P[11]=B=>A(S).current.option.corners_square_options.color=B),size:ct},{default:st(()=>[H(J,{modelValue:A(S).current.option.corners_square_options.type,"onUpdate:modelValue":P[10]||(P[10]=B=>A(S).current.option.corners_square_options.type=B),options:A(Pt)(["dot","square","extra-rounded"],"qrCode_generate_option_"),size:ct,label:k.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),H(Dt,{modelValue:A(S).current.option.corners_dot_options.color,"onUpdate:modelValue":P[13]||(P[13]=B=>A(S).current.option.corners_dot_options.color=B),size:ct},{default:st(()=>[H(J,{modelValue:A(S).current.option.corners_dot_options.type,"onUpdate:modelValue":P[12]||(P[12]=B=>A(S).current.option.corners_dot_options.type=B),options:A(Pt)(["dot","square"],"qrCode_generate_option_"),size:ct,label:k.$t("qrCode_generate_option_style")},null,8,["modelValue","options","label"])]),_:1},8,["modelValue"]),H(Dt,{modelValue:A(S).current.option.background_options.color,"onUpdate:modelValue":P[14]||(P[14]=B=>A(S).current.option.background_options.color=B),size:ct},null,8,["modelValue"])]),_:1},8,["modelValue","lists"])])):It("",!0)],64)}}});export{de as default};
