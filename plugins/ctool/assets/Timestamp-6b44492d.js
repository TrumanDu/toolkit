import{u as H,i as M}from"./action-cd384d03.js";import{ae as c,d as A,y as L,z as E,D as h,I as N,H as O,r as $,A as U,c as x,w as d,f as z,v as r,j as a,m as C,B as j,k as F,s as k,l as D,n as q}from"./tool-4bde39df.js";import{u as G,t as J,a as K}from"./timezone-9b70cca4.js";import"./modulepreload-polyfill-3cfb730f.js";var Y=(t=>(t[t.error=0]="error",t[t.empty=1]="empty",t[t.normal=2]="normal",t[t.unix=3]="unix",t))(Y||{}),V=(t=>(t.second="second",t.millisecond="millisecond",t.nanosecond="nanosecond",t))(V||{});const g={second:0,millisecond:3,nanosecond:9},P=(t,p,u="auto")=>{const{type:n,format:l}=Q(t);u=u==="auto"?l:u;try{if(n===1)return{isValid:!1,second:"",millisecond:"",nanosecond:""};if(n===0)throw new Error($t("time_error_format"));let m,s;const f=g[u];if(n===2){const _=t.split(".");m=(_[1]||"").slice(0,f),s=c.tz(_[0],p)}else s=c(parseInt(f?t.slice(0,-1*f):t)*1e3).tz(p),m=f?t.slice(-1*f):"";if(!s.isValid())throw new Error($t("time_error_format"));const e=n===2?s.unix().toString():s.format("YYYY-MM-DD HH:mm:ss"),o=m.slice(0,g.millisecond).padEnd(g.millisecond,"0"),y=m.slice(0,g.nanosecond).padEnd(g.nanosecond,"0"),v=n===2?"":".";return{isValid:!0,second:e,millisecond:`${e}${v}${o}`,nanosecond:`${e}${v}${y}`,format:u,autoFormat:l,type:n}}catch(m){const s=$error(m);return{isValid:!1,second:s,millisecond:s,nanosecond:s,type:n,format:u,autoFormat:l}}},Q=t=>t===""?{type:1,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(t)?{type:2,format:"second"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{0,3}$/).test(t)?{type:2,format:"millisecond"}:new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d{4,9}$/).test(t)?{type:2,format:"nanosecond"}:new RegExp(/^-?\d{1,12}$/).test(t)?{type:3,format:"second"}:new RegExp(/^-?\d{13,16}$/).test(t)?{type:3,format:"millisecond"}:new RegExp(/^-?\d{17,}$/).test(t)?{type:3,format:"nanosecond"}:{type:0,format:"second"},T="auto",te=A({__name:"Timestamp",async setup(t){let p,u;c.extend(G),c.extend(J);const n=H(([p,u]=L(()=>M({input:"",timezone:c.tz.guess(),format:T},{paste:e=>new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+$/).test(e)||new RegExp(/^\d+-\d+-\d+ \d+:\d+:\d+\.\d+$/).test(e)||new RegExp(/^-?\d{5,}$/).test(e)||new RegExp(/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?$/).test(e)})),p=await p,u(),p)),l=E(()=>{let e=(n.current.input||"").trim();return n.current.input.toLowerCase().includes("e")&&(e=`${parseFloat(n.current.input)}`),P(e,n.current.timezone,n.current.format)});h(()=>({data:n.current,is_valid:l.value.isValid,format:l.value.format}),({is_valid:e})=>{e&&n.save()},{immediate:!0,deep:!0});let m=N(c().valueOf());const s=setInterval(()=>{m.value=c().valueOf()},100);O(()=>{clearInterval(s)});const f=E(()=>{const e=c(m.value).tz(n.current.timezone);return[{format:$t("time_normal_second"),value:e.format("YYYY-MM-DD HH:mm:ss")},{format:$t("time_unix_second"),value:e.unix().toString()},{format:$t("time_normal_millisecond"),value:e.format("YYYY-MM-DD HH:mm:ss.SSS")},{format:$t("time_unix_millisecond"),value:e.valueOf().toString()}]});return(e,o)=>{const y=$("Select"),v=$("Input"),_=$("Button"),b=$("Align"),w=$("Display"),R=$("Link"),S=$("Table"),B=U("row");return z(),x(b,{direction:"vertical"},{default:d(()=>[r(y,{size:"large",width:"100%",center:!1,label:e.$t("time_timezone"),modelValue:a(n).current.timezone,"onUpdate:modelValue":o[0]||(o[0]=i=>a(n).current.timezone=i),options:a(K),onChange:o[1]||(o[1]=i=>a(n).current.timezone=i)},null,8,["label","modelValue","options"]),r(w,{position:"right-center"},{extra:d(()=>[r(b,null,{default:d(()=>[l.value.type===a(Y).unix?(z(),x(y,{key:0,modelValue:a(n).current.format,"onUpdate:modelValue":o[3]||(o[3]=i=>a(n).current.format=i),size:"small",options:[{value:"auto",label:`${e.$t("time_unix_auto")}:${e.$t(`time_unix_${l.value.autoFormat}`)}`},{value:a(V).second,label:e.$t("time_unix_second")},{value:a(V).millisecond,label:e.$t("time_unix_millisecond")},{value:a(V).nanosecond,label:e.$t("time_unix_nanosecond")}]},null,8,["modelValue","options"])):C("",!0),a(n).current.input!==""?(z(),x(_,{key:1,text:e.$t("main_ui_clear"),onClick:o[4]||(o[4]=i=>a(n).current.input=""),size:"small"},null,8,["text"])):C("",!0)]),_:1})]),default:d(()=>[r(v,{size:"large",modelValue:a(n).current.input,"onUpdate:modelValue":o[2]||(o[2]=i=>a(n).current.input=i),label:e.$t("main_ui_input"),placeholder:e.$t("time_timestamp_input_placeholder")},null,8,["modelValue","label","placeholder"])]),_:1}),r(w,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[5]||(o[5]=()=>e.$copy(l.value.second))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.second,label:e.$t("time_second")},null,8,["model-value","label"])]),_:1},8,["text"]),j((z(),F("div",null,[r(w,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[6]||(o[6]=()=>e.$copy(l.value.millisecond))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.millisecond,label:e.$t("time_millisecond")},null,8,["model-value","label"])]),_:1},8,["text"]),r(w,{position:"right-center",text:l.value.isValid?e.$t("main_ui_copy"):"",onClick:o[7]||(o[7]=()=>e.$copy(l.value.nanosecond))},{default:d(()=>[r(v,{readonly:"",size:"large","model-value":l.value.nanosecond,label:e.$t("time_nanosecond")},null,8,["model-value","label"])]),_:1},8,["text"])])),[[B,"1-1"]]),k("div",null,[r(S,{columns:[{title:e.$t("time_format"),key:"format"},{title:e.$t("time_value"),key:"value"}],lists:f.value,"action-width":100,border:""},{column:d(({row:i})=>[k("td",null,D(i.format),1),k("td",null,[r(R,{onClick:W=>e.$copy(i.value)},{default:d(()=>[q(D(i.value),1)]),_:2},1032,["onClick"])])]),default:d(({row:i})=>[r(_,{text:e.$t("main_ui_load"),onClick:()=>a(n).current.input=`${i.value}`,size:"small"},null,8,["text","onClick"])]),_:1},8,["columns","lists"])])]),_:1})}}});export{te as default};
