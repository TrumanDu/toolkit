import{u as T,i as k}from"./action-cd384d03.js";import{d as z,y as D,z as S,r as d,A as M,B as U,k as v,v as a,w as m,f as w,j as p,F as j,q as I,c as L,C as H,T as F}from"./tool-4bde39df.js";import{C as s}from"./index-97831974.js";import{s as R}from"./index-4f173d59.js";import"./modulepreload-polyfill-3cfb730f.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-10d6d5e1.js";import"./string_decoder-fc53e566.js";import"./index-847cce26.js";const y=["md5","sha1","sha256","sha512","sm3"],V={md5:(o,t)=>s.HmacMD5(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha1:(o,t)=>s.HmacSHA1(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha256:(o,t)=>s.HmacSHA256(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sha512:(o,t)=>s.HmacSHA512(s.enc.Base64.parse(o.toBase64()),s.enc.Base64.parse(t.toBase64())).toString(),sm3:(o,t)=>{const h=(l,r)=>l.length>=r?l:new Array(r-l.length+1).join("0")+l;let e=o.toHexString();const _=[];let f=e.length;f%2!==0&&(e=h(e,f+1)),f=e.length;for(let l=0;l<f;l+=2)_.push(parseInt(e.substr(l,2),16));return R.sm3(_,{key:t.toHexString()})}},A=(o,t,h)=>{if(!Object.keys(V).includes(o))throw new Error(`hmac method 不存在: ${o}`);return V[o](t,h)},X=z({__name:"Hmac",async setup(o){let t,h;const e=T(([t,h]=D(()=>k({input:H(),secret:H("text"),is_uppercase:!1,multiple:!1})),t=await t,h(),t)),_=S(()=>["text"].includes(e.current.input.type)),f=S(()=>{let r={md5:"",sha1:"",sha256:"",sha512:"",sm3:""};if(e.current.input.text.isEmpty()||e.current.secret.text.isEmpty())return r;let n=!1;for(let u of y)try{if(e.current.input.text.isError())throw new Error(`input:${e.current.input.text.toString()}`);if(e.current.secret.text.isError())throw new Error(`secret:${e.current.secret.text.toString()}`);const i=l(u,e.current.input.text,e.current.secret.text,_.value&&e.current.multiple);r[u]=e.current.is_uppercase?i.toUpperCase():i.toLowerCase()}catch(i){n=!0,r[u]=$error(i)}return n||e.save(),r}),l=(r,n,u,i)=>i?n.toString().split(`
`).map(x=>A(r,F.fromString(x,n.encoding()),u)).join(`
`):A(r,n,u);return(r,n)=>{const u=d("TextInput"),i=d("HeightResize"),x=d("Bool"),b=d("Tooltip"),B=d("Align"),C=d("Display"),$=d("Textarea"),E=M("row");return U((w(),v("div",null,[a(B,{direction:"vertical"},{default:m(()=>[a(u,{class:"ctool-page-option",modelValue:p(e).current.secret,"onUpdate:modelValue":n[0]||(n[0]=c=>p(e).current.secret=c),"use-input":r.$t("hmac_secret"),allow:["text","hex","base64"]},null,8,["modelValue","use-input"]),a(C,null,{extra:m(()=>[a(B,null,{default:m(()=>[a(x,{size:"small",modelValue:p(e).current.is_uppercase,"onUpdate:modelValue":n[2]||(n[2]=c=>p(e).current.is_uppercase=c),border:"",label:r.$t("hmac_uppercase")},null,8,["modelValue","label"]),a(b,{content:r.$t("hmac_multiple_tooltip")},{default:m(()=>[a(x,{disabled:!_.value,size:"small",modelValue:p(e).current.multiple,"onUpdate:modelValue":n[3]||(n[3]=c=>p(e).current.multiple=c),border:"",label:r.$t("hmac_multiple")},null,8,["disabled","modelValue","label"])]),_:1},8,["content"])]),_:1})]),default:m(()=>[a(i,{append:[".ctool-page-option"],reduce:5},{default:m(({height:c})=>[a(u,{modelValue:p(e).current.input,"onUpdate:modelValue":n[1]||(n[1]=g=>p(e).current.input=g),height:c,upload:"file",encoding:""},null,8,["modelValue","height"])]),_:1},8,["append"])]),_:1})]),_:1}),a(i,null,{default:m(({height:c})=>[a(B,{direction:"vertical"},{default:m(()=>[(w(!0),v(j,null,I(p(y),g=>(w(),L($,{"model-value":f.value[g],height:(c-20)/5,placeholder:`HMAC-${g}`,copy:`HMAC-${g}`},null,8,["model-value","height","placeholder","copy"]))),256))]),_:2},1024)]),_:1})])),[[E,"10-14"]])}}});export{X as default};
